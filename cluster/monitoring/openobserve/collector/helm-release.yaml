---
apiVersion: helm.toolkit.fluxcd.io/v2beta2
kind: HelmRelease
metadata:
  name: o2-collector
  namespace: monitoring
spec:
  interval: 5m
  chart:
    spec:
      # renovate: registryUrl=https://charts.openobserve.ai
      chart: openobserve-collector
      version: 0.3.3
      sourceRef:
        kind: HelmRepository
        name: openobserve-charts
        namespace: flux-system
      interval: 5m
  valuesFrom:
    - kind: Secret
      name: openobserve-secrets
      valuesKey: OTLP_ENDPOINT
      targetPath: exporters.otlp.http_openobserve.endpoint
    - kind: Secret
      name: openobserve-secrets
      valuesKey: OTLP_AUTH
      targetPath: exporters.otlp.http_openobserve.headers.Authorization
    - kind: Secret
      name: openobserve-secrets
      valuesKey: OTLP_ENDPOINT
      targetPath: exporters.otl.http_openobserve_k8s_events.endpoint
    - kind: Secret
      name: openobserve-secrets
      valuesKey: OTLP_AUTH
      targetPath: exporters.otlp.http_openobserve_k8s_events.headers.Authorization
  values:
    nameOverride: o2-collector
    fullnameOverride: o2-collector
    image:
      # renovate: dockerUrl=ghcr.io/open-telemetry/opentelemetry-collector-releases/opentelemetry-collector-contrib
      tag: "0.99.0"
